{"ast":null,"code":"import _toConsumableArray from \"@babel/runtime/helpers/toConsumableArray\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\n\nvar _this = this,\n    _jsxFileName = \"D:\\\\angular\\\\hts_reactnative\\\\src\\\\app\\\\screens\\\\details\\\\TabManagement\\\\StaffManagement\\\\Reports\\\\WeeklyCrewSchedule.tsx\";\n\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport React, { useState, useEffect } from \"react\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport View from \"react-native-web/dist/exports/View\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport ScrollView from \"react-native-web/dist/exports/ScrollView\";\nimport { LinearGradient } from \"expo-linear-gradient\";\nimport { colors } from \"../../../../../utils/Colors\";\nimport { Ionicons } from \"@expo/vector-icons\";\nimport ItemServiceTeam from \"./items/itemServiceTeam\";\nimport { Table, Row } from \"react-native-table-component\";\nimport ModalSendEmail from \"../../../../../components/ModalSendEmail\";\nimport ModalPicker from \"../../../../../components/management/ModalPicker\";\nimport SendSuccess from \"../../../../../components/modalNotification/SendSuccess\";\nimport SendFail from \"../../../../../components/modalNotification/SendFail\";\nimport moment from \"moment\";\nimport Dash from \"react-native-dash\";\nimport { StaffService, ReportStaffService, MailStaffService } from \"../../../../../netWorking/staffService\";\nimport Loading from \"../../../../../components/dialogs/Loading\";\nimport { InitHourService, initDataPicker } from \"../../../../../models/staffModel\";\nimport { useSelector } from \"react-redux\";\nimport { getMonday } from \"../../../../../components/generalConvert/conVertMonDay\";\nimport DropDown from \"../../../../../components/dropDown/DropDown\";\n\nvar WeeklyCrewSchedule = function WeeklyCrewSchedule(props) {\n  var params = props.props.route.params;\n  var workingTimes = useSelector(function (state) {\n    return state.staff.workingTimes;\n  });\n  var record_area = useSelector(function (state) {\n    return state.staff.record_area;\n  });\n  var staffs = useSelector(function (state) {\n    return state.staff.staffs;\n  });\n  var reports = useSelector(function (state) {\n    return state.reports;\n  });\n  var toDate = new Date();\n\n  var _useState = useState(false),\n      _useState2 = _slicedToArray(_useState, 2),\n      isLoading = _useState2[0],\n      setIsLoading = _useState2[1];\n\n  var tableHead = [];\n  var tableRow = [];\n  var widthArr = [];\n  workingTimes.map(function (item) {\n    tableHead.push(item.timeRange.slice(0, 5));\n    tableRow.push(\"-\");\n    widthArr.push(50);\n  });\n\n  var _useState3 = useState(false),\n      _useState4 = _slicedToArray(_useState3, 2),\n      modalSendMail = _useState4[0],\n      setModalSendMail = _useState4[1];\n\n  var _useState5 = useState(\"\"),\n      _useState6 = _slicedToArray(_useState5, 2),\n      sent = _useState6[0],\n      setSent = _useState6[1];\n\n  var _useState7 = useState(\"\"),\n      _useState8 = _slicedToArray(_useState7, 2),\n      statusSent = _useState8[0],\n      setStatusSent = _useState8[1];\n\n  var _useState9 = useState(moment(new Date()).format(\"YYYY-MM-DD 00:00:00\")),\n      _useState10 = _slicedToArray(_useState9, 2),\n      date = _useState10[0],\n      setDate = _useState10[1];\n\n  var _useState11 = useState(false),\n      _useState12 = _slicedToArray(_useState11, 2),\n      showPickerStore = _useState12[0],\n      setShowPickerStore = _useState12[1];\n\n  var _useState13 = useState(initDataPicker),\n      _useState14 = _slicedToArray(_useState13, 2),\n      valueStore = _useState14[0],\n      setValueStore = _useState14[1];\n\n  var _useState15 = useState(false),\n      _useState16 = _slicedToArray(_useState15, 2),\n      showPickerTeam = _useState16[0],\n      setShowPickerTeam = _useState16[1];\n\n  var _useState17 = useState(initDataPicker),\n      _useState18 = _slicedToArray(_useState17, 2),\n      valueTeam = _useState18[0],\n      setValueTeam = _useState18[1];\n\n  var _useState19 = useState(InitHourService),\n      _useState20 = _slicedToArray(_useState19, 2),\n      dataHourService = _useState20[0],\n      setDataHourService = _useState20[1];\n\n  var _useState21 = useState([]),\n      _useState22 = _slicedToArray(_useState21, 2),\n      dataHourServiceInWeek = _useState22[0],\n      setDataHourServiceInWeek = _useState22[1];\n\n  var _useState23 = useState([]),\n      _useState24 = _slicedToArray(_useState23, 2),\n      listStaff = _useState24[0],\n      setListStaff = _useState24[1];\n\n  var _useState25 = useState([]),\n      _useState26 = _slicedToArray(_useState25, 2),\n      recordAreas = _useState26[0],\n      setRecordAreas = _useState26[1];\n\n  var _useState27 = useState([]),\n      _useState28 = _slicedToArray(_useState27, 2),\n      tempStaffs = _useState28[0],\n      setTempStaffs = _useState28[1];\n\n  var _useState29 = useState({\n    label: moment(getMonday(toDate)).format(\"dddd (DD-MM-YYYY)\"),\n    value: +getMonday(toDate)\n  }),\n      _useState30 = _slicedToArray(_useState29, 2),\n      daySelect = _useState30[0],\n      setDaySelect = _useState30[1];\n\n  function getDaysArray(start, end) {\n    var arr = [];\n\n    for (var dt = start; new Date(dt) <= end; dt.setDate(dt.getDate() + 1)) {\n      arr.push({\n        value: +new Date(dt),\n        label: moment(new Date(dt)).format(\"dddd (DD-MM-YYYY)\")\n      });\n    }\n\n    return arr;\n  }\n\n  var _useState31 = useState([]),\n      _useState32 = _slicedToArray(_useState31, 2),\n      weekDays = _useState32[0],\n      setWeekDays = _useState32[1];\n\n  var handleSubmitWorking = function handleSubmitWorking() {\n    var req, res;\n    return _regeneratorRuntime.async(function handleSubmitWorking$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            req = [];\n            tempStaffs.map(function (staff) {\n              if (staff.edited) {\n                var listWorking = [];\n                staff.workingScheduleData.map(function (item) {\n                  if (item.WorkingWeekTime !== null || item.LegendId !== null) {\n                    listWorking.push(item);\n                  }\n                });\n                req.push({\n                  StaffId: staff.id,\n                  WorkingScheduleData: listWorking\n                });\n              }\n            });\n            _context.next = 4;\n            return _regeneratorRuntime.awrap(StaffService.createWorking(req));\n\n          case 4:\n            res = _context.sent;\n\n            if (!(res.isSuccess == 1 && res.data)) {\n              _context.next = 9;\n              break;\n            }\n\n            return _context.abrupt(\"return\", true);\n\n          case 9:\n            return _context.abrupt(\"return\", false);\n\n          case 10:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  var handleSendMail = function handleSendMail(description, email) {\n    var submit, res;\n    return _regeneratorRuntime.async(function handleSendMail$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            submit = false;\n\n            if (!(params != null && params.data)) {\n              _context2.next = 7;\n              break;\n            }\n\n            _context2.next = 4;\n            return _regeneratorRuntime.awrap(handleSubmitWorking());\n\n          case 4:\n            submit = _context2.sent;\n            _context2.next = 8;\n            break;\n\n          case 7:\n            submit = true;\n\n          case 8:\n            if (!submit) {\n              _context2.next = 18;\n              break;\n            }\n\n            setModalSendMail(!modalSendMail);\n            setIsLoading(true);\n            _context2.next = 13;\n            return _regeneratorRuntime.awrap(MailStaffService.sendMailWeeklyCrewsCheduleAndOTForecastSample(moment(getMonday(new Date())).format(\"YYYY-MM-DD HH:mm:ss\"), description, email));\n\n          case 13:\n            res = _context2.sent;\n            setIsLoading(false);\n\n            if (res.isSuccess == 1 && res.data) {\n              setSent(\"success\");\n              setStatusSent(\"Email sent successfully!\");\n            } else {\n              setSent(\"fail\");\n              setStatusSent(\"Email sent failed!\");\n            }\n\n            _context2.next = 20;\n            break;\n\n          case 18:\n            setSent(\"fail\");\n            setStatusSent(\"Schedule work failed!\");\n\n          case 20:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  var loadHourStore = function loadHourStore() {\n    var res;\n    return _regeneratorRuntime.async(function loadHourStore$(_context3) {\n      while (1) {\n        switch (_context3.prev = _context3.next) {\n          case 0:\n            _context3.next = 2;\n            return _regeneratorRuntime.awrap(ReportStaffService.getHourStoreService(moment(daySelect.value).format(\"YYYY-MM-DD 00:00:00\"), valueStore.id));\n\n          case 2:\n            res = _context3.sent;\n\n            if (res.isSuccess == 1 && res.data.length > 0) {\n              setDataHourService(res.data[0]);\n            }\n\n          case 4:\n          case \"end\":\n            return _context3.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  var loadStaffByRecordArea = function loadStaffByRecordArea() {\n    var res, memberInfos, result;\n    return _regeneratorRuntime.async(function loadStaffByRecordArea$(_context5) {\n      while (1) {\n        switch (_context5.prev = _context5.next) {\n          case 0:\n            setIsLoading(true);\n            _context5.next = 3;\n            return _regeneratorRuntime.awrap(ReportStaffService.getStaffByRecordArea(valueTeam.id));\n\n          case 3:\n            res = _context5.sent;\n\n            if (!(res.isSuccess == 1 && res.data)) {\n              _context5.next = 15;\n              break;\n            }\n\n            if (!(res.data.length > 0)) {\n              _context5.next = 14;\n              break;\n            }\n\n            setListStaff(res.data);\n            memberInfos = res.data.map(function _callee(t) {\n              return _regeneratorRuntime.async(function _callee$(_context4) {\n                while (1) {\n                  switch (_context4.prev = _context4.next) {\n                    case 0:\n                      _context4.next = 2;\n                      return _regeneratorRuntime.awrap(loadWeeklyDynamicCrewScheduleByStaff(t.staffId, res.data));\n\n                    case 2:\n                      return _context4.abrupt(\"return\", _context4.sent);\n\n                    case 3:\n                    case \"end\":\n                      return _context4.stop();\n                  }\n                }\n              }, null, null, null, Promise);\n            });\n            _context5.next = 10;\n            return _regeneratorRuntime.awrap(Promise.all(memberInfos));\n\n          case 10:\n            result = _context5.sent;\n            setListStaff(result);\n            _context5.next = 15;\n            break;\n\n          case 14:\n            setListStaff([]);\n\n          case 15:\n            setIsLoading(false);\n\n          case 16:\n          case \"end\":\n            return _context5.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  var loadWeeklyDynamicCrewScheduleByStaff = function loadWeeklyDynamicCrewScheduleByStaff(staffId, data) {\n    var res, index, list, dataTable, datahandle, tempCheckSplitTime;\n    return _regeneratorRuntime.async(function loadWeeklyDynamicCrewScheduleByStaff$(_context6) {\n      while (1) {\n        switch (_context6.prev = _context6.next) {\n          case 0:\n            _context6.next = 2;\n            return _regeneratorRuntime.awrap(ReportStaffService.getWeeklyDynamicCrewScheduleByStaff(staffId, moment(daySelect.value).format(\"YYYY-MM-DD 00:00:00\"), valueTeam.id));\n\n          case 2:\n            res = _context6.sent;\n\n            if (!(res.isSuccess == 1 && res.data)) {\n              _context6.next = 18;\n              break;\n            }\n\n            index = data.findIndex(function (i) {\n              return i.staffId == staffId;\n            });\n\n            if (!(res.data.length > 0)) {\n              _context6.next = 17;\n              break;\n            }\n\n            list = _toConsumableArray(data);\n\n            if (!(index !== -1)) {\n              _context6.next = 15;\n              break;\n            }\n\n            dataTable = [].concat(tableRow);\n            list[index] = res.data[0];\n            datahandle = list[index].staffWorkingDay[0].staffWorkingDayTimeData;\n            tempCheckSplitTime = 0;\n            datahandle.map(function (item, index) {\n              if (item.isOT) {\n                dataTable[item.workingTimeId - 1] = \"OT\";\n              } else {\n                dataTable[item.workingTimeId - 1] = \"N\";\n              }\n\n              if (index == datahandle.length - 1) {\n                dataTable[datahandle[index].workingTimeId] = dataTable[datahandle[index].workingTimeId - 1];\n              }\n\n              if (index == 0) {\n                tempCheckSplitTime = item.workingTimeId + 2;\n              } else {\n                if (item.workingTimeId + 1 !== tempCheckSplitTime) {\n                  dataTable[tempCheckSplitTime - 2] = dataTable[tempCheckSplitTime - 3];\n                } else {\n                  tempCheckSplitTime = item.workingTimeId + 2;\n                }\n              }\n            });\n            list[index].dataTable = dataTable;\n            return _context6.abrupt(\"return\", list[index]);\n\n          case 15:\n            _context6.next = 18;\n            break;\n\n          case 17:\n            return _context6.abrupt(\"return\", data[index]);\n\n          case 18:\n          case \"end\":\n            return _context6.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  useEffect(function () {\n    if (params.data === undefined) {\n      loadHourStore();\n    }\n  }, [valueStore, daySelect.value]);\n  useEffect(function () {\n    if (params.data === undefined) {\n      loadStaffByRecordArea();\n    }\n  }, [valueTeam, daySelect.value]);\n  useEffect(function () {\n    if (params.data === undefined) {\n      var _arrDays = getDaysArray(new Date(moment(reports.fromDate).format(\"YYYY-MM-DD\")), new Date(moment(reports.endDate).format(\"YYYY-MM-DD\")));\n\n      setWeekDays(_arrDays);\n      setDaySelect(_arrDays[0]);\n    }\n  }, [reports]);\n  useEffect(function () {\n    setRecordAreas(record_area);\n    setValueStore(record_area[0]);\n    setValueTeam(record_area[0]);\n\n    if (params != null && params.data) {\n      setTempStaffs(staffs);\n      setValueStore(params.data.valueRecordArea);\n      setValueTeam(params.data.valueRecordArea);\n\n      var _arrDays = getDaysArray(new Date(moment(params.data.fromDateTime).format(\"YYYY-MM-DD\")), new Date(moment(params.data.endDateTime).format(\"YYYY-MM-DD\")));\n\n      setWeekDays(_arrDays);\n      setDaySelect(_arrDays[0]);\n      var listStaffParam = [];\n\n      var _dataHour = Array.from({\n        length: 7\n      }).map(function (_) {\n        return {\n          totalHoureWorking: 0,\n          totalHoureWorkingOT: 0,\n          totalHoure: 0\n        };\n      });\n\n      staffs.map(function (item) {\n        var _staffWorkingDay = [];\n        var _dataTable = [];\n        item.staffWorkingDayTimeData.forEach(function (i) {\n          var _totalHoureWorking = 0;\n          var _totalHoureWorkingOT = 0;\n          var _totalHoure = 0;\n\n          var _dataRow = [].concat(tableRow);\n\n          var __index = new Date(moment(i.WorkingDate).format('YYYY-MM-DD')).getDay() - 1;\n\n          if (__index === -1) {\n            __index = 6;\n          }\n\n          var datahandle = i.staffWorkingDayTimeData;\n          var tempCheckSplitTime = 0;\n          datahandle.map(function (item, index) {\n            if (item.isOT) {\n              _dataRow[item.workingTimeId - 1] = \"OT\";\n              _totalHoureWorkingOT = _totalHoureWorkingOT + 1;\n            } else {\n              _totalHoureWorking += 1;\n              _dataRow[item.workingTimeId - 1] = \"N\";\n            }\n\n            if (index == datahandle.length - 1) {\n              _dataRow[datahandle[index].workingTimeId] = _dataRow[datahandle[index].workingTimeId - 1];\n            }\n\n            if (index == 0) {\n              tempCheckSplitTime = item.workingTimeId + 2;\n            } else {\n              if (item.workingTimeId + 1 !== tempCheckSplitTime) {\n                _dataRow[tempCheckSplitTime - 2] = _dataRow[tempCheckSplitTime - 3];\n              } else {\n                tempCheckSplitTime = item.workingTimeId + 2;\n              }\n            }\n          });\n\n          var _index = _dataTable.findIndex(function (e) {\n            return e.date == i.WorkingDate;\n          });\n\n          if (_index !== -1) {\n            _dataTable[_index].data = _dataRow;\n          }\n\n          _totalHoure = _totalHoureWorking + _totalHoureWorkingOT;\n\n          _dataTable.push({\n            date: i.WorkingDate,\n            data: _dataRow,\n            dataHour: {\n              totalHoureWorking: _totalHoureWorking / 2,\n              totalHoureWorkingOT: _totalHoureWorkingOT / 2,\n              totalHoure: _totalHoure / 2\n            }\n          });\n\n          _dataHour[__index].totalHoure += _totalHoure / 2;\n          _dataHour[__index].totalHoureWorkingOT += _totalHoureWorkingOT / 2;\n          _dataHour[__index].totalHoureWorking += _totalHoureWorking / 2;\n        });\n        var infoStaff = {\n          staffId: item.id,\n          staffName: \"\" + item.firstName + item.lastName,\n          positionName: item.positionName,\n          positionCode: item.positionId,\n          dutyName: item.dutyName,\n          dutyId: item.dutyId,\n          dataTable: [],\n          dataTableInWeek: _dataTable\n        };\n        listStaffParam.push(infoStaff);\n      });\n      setDataHourServiceInWeek(_dataHour);\n      setListStaff(listStaffParam);\n    }\n  }, []);\n\n  var handleDataTableStaff = function handleDataTableStaff(item) {\n    if (params != null && params.data) {\n      var index = item.dataTableInWeek.findIndex(function (item) {\n        return +new Date(moment(item.date).format(\"YYYY-MM-DD\")) === +new Date(daySelect.value);\n      });\n\n      if (index !== -1) {\n        return item.dataTableInWeek[index].data;\n      }\n    } else {\n      var _item$dataTable;\n\n      return item ? (_item$dataTable = item.dataTable) != null ? _item$dataTable : tableRow : tableRow;\n    }\n  };\n\n  var handleDataHourTableStaff = function handleDataHourTableStaff(item, type) {\n    if (params != null && params.data) {\n      var index = item.dataTableInWeek.findIndex(function (item) {\n        return +new Date(moment(item.date).format(\"YYYY-MM-DD\")) === +new Date(daySelect.value);\n      });\n\n      if (index !== -1) {\n        return item.dataTableInWeek[index].dataHour[type];\n      }\n    } else {\n      return item[type];\n    }\n  };\n\n  var handleDataHourStore = function handleDataHourStore(type) {\n    if (params != null && params.data) {\n      var index = new Date(daySelect.value).getDay() - 1;\n\n      if (index !== -1 && dataHourServiceInWeek.length > 0) {\n        return dataHourServiceInWeek[index][type];\n      }\n    } else {\n      return dataHourService[type] ? dataHourService[type].toFixed(1) : \"-\";\n    }\n  };\n\n  return React.createElement(View, {\n    style: styles.container,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 383,\n      columnNumber: 5\n    }\n  }, React.createElement(View, {\n    style: {\n      paddingHorizontal: 15,\n      zIndex: 2\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 384,\n      columnNumber: 7\n    }\n  }, React.createElement(View, {\n    style: styles.titleHeader,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 385,\n      columnNumber: 9\n    }\n  }, React.createElement(Text, {\n    style: [styles.textTitleHeader, {\n      textAlign: \"center\"\n    }],\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 386,\n      columnNumber: 11\n    }\n  }, \"Weekly crew schedule & OT Forecast Sample\")), React.createElement(View, {\n    style: {\n      zIndex: 2\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 393,\n      columnNumber: 9\n    }\n  }, React.createElement(DropDown, {\n    data: weekDays,\n    onSelected: function onSelected(value) {\n      setDaySelect(value);\n    },\n    backgroundColor: {\n      backgroundColor: \"transparent\"\n    },\n    value: daySelect,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 394,\n      columnNumber: 11\n    }\n  })), React.createElement(View, {\n    style: {\n      backgroundColor: colors.colorLine,\n      height: .5\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 404,\n      columnNumber: 9\n    }\n  }), React.createElement(View, {\n    style: [styles.row_between, {\n      paddingVertical: 10\n    }],\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 406,\n      columnNumber: 9\n    }\n  }, React.createElement(Text, {\n    style: {\n      color: colors.gray\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 407,\n      columnNumber: 11\n    }\n  }, \"Start time of day:\"), React.createElement(Text, {\n    style: styles.textTitleHeader,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 408,\n      columnNumber: 11\n    }\n  }, \"00:00\"))), React.createElement(View, {\n    style: {\n      borderRadius: 4,\n      marginTop: 6,\n      backgroundColor: colors.grayLight\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 411,\n      columnNumber: 7\n    }\n  }, React.createElement(View, {\n    style: [styles.center, styles.radius_top, {\n      backgroundColor: \"#878787\"\n    }],\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 418,\n      columnNumber: 9\n    }\n  }, React.createElement(Text, {\n    style: styles.textTitleHeader,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 419,\n      columnNumber: 11\n    }\n  }, \"STORE_\" + valueStore.name.toUpperCase()), params.data === undefined && React.createElement(TouchableOpacity, {\n    onPress: function onPress() {\n      setShowPickerStore(!showPickerStore);\n    },\n    style: {\n      position: \"absolute\",\n      alignSelf: \"flex-end\",\n      right: 15,\n      padding: 10\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 420,\n      columnNumber: 41\n    }\n  }, React.createElement(Ionicons, {\n    style: {},\n    name: \"caret-down\",\n    size: 20,\n    color: \"#fff\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 431,\n      columnNumber: 13\n    }\n  }))), React.createElement(View, {\n    style: {\n      padding: 15\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 436,\n      columnNumber: 9\n    }\n  }, React.createElement(View, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 437,\n      columnNumber: 11\n    }\n  }, React.createElement(View, {\n    style: [styles.row_between, {\n      marginVertical: 10\n    }],\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 438,\n      columnNumber: 13\n    }\n  }, React.createElement(Text, {\n    style: {\n      color: colors.gray\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 439,\n      columnNumber: 15\n    }\n  }, \"Actual working hours\"), React.createElement(Text, {\n    style: styles.textTitleHeader,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 440,\n      columnNumber: 15\n    }\n  }, handleDataHourStore('totalHoureWorking'))), React.createElement(View, {\n    style: styles.row_between,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 444,\n      columnNumber: 13\n    }\n  }, React.createElement(Text, {\n    style: {\n      color: colors.gray\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 445,\n      columnNumber: 15\n    }\n  }, \"OT\"), React.createElement(Text, {\n    style: styles.textTitleHeader,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 446,\n      columnNumber: 15\n    }\n  }, handleDataHourStore('totalHoureWorkingOT'))), React.createElement(View, {\n    style: [styles.row_between, {\n      marginVertical: 10\n    }],\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 450,\n      columnNumber: 13\n    }\n  }, React.createElement(Text, {\n    style: {\n      color: colors.gray\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 451,\n      columnNumber: 15\n    }\n  }, \"Total\"), React.createElement(Text, {\n    style: styles.textTitleHeader,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 452,\n      columnNumber: 15\n    }\n  }, handleDataHourStore('totalHoure')))))), React.createElement(View, {\n    style: {\n      borderRadius: 4,\n      marginTop: 6,\n      backgroundColor: colors.grayLight\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 460,\n      columnNumber: 7\n    }\n  }, React.createElement(View, {\n    style: [styles.row_between, styles.radius_top, {\n      padding: 15\n    }],\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 467,\n      columnNumber: 9\n    }\n  }, React.createElement(View, {\n    style: {\n      flexDirection: \"row\"\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 468,\n      columnNumber: 11\n    }\n  }, React.createElement(Text, {\n    style: styles.textTitleHeader,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 469,\n      columnNumber: 13\n    }\n  }, \"N: \"), React.createElement(Text, {\n    style: [styles.textTitleHeader, {\n      color: colors.gray\n    }],\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 470,\n      columnNumber: 13\n    }\n  }, \"Normal Working Hour\")), React.createElement(View, {\n    style: {\n      flexDirection: \"row\"\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 472,\n      columnNumber: 11\n    }\n  }, React.createElement(Text, {\n    style: styles.textTitleHeader,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 473,\n      columnNumber: 13\n    }\n  }, \"OT: \"), React.createElement(Text, {\n    style: [styles.textTitleHeader, {\n      color: colors.gray\n    }],\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 474,\n      columnNumber: 13\n    }\n  }, \"Overtime\"))), React.createElement(View, {\n    style: {\n      backgroundColor: \"#878787\",\n      padding: 15,\n      justifyContent: \"center\"\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 477,\n      columnNumber: 9\n    }\n  }, React.createElement(Text, {\n    style: [styles.textTitleHeader, {\n      alignSelf: \"center\"\n    }],\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 484,\n      columnNumber: 11\n    }\n  }, valueTeam.name.toUpperCase() + \" TEAM\"), params.data === undefined && React.createElement(TouchableOpacity, {\n    onPress: function onPress() {\n      setShowPickerTeam(!showPickerTeam);\n    },\n    style: {\n      position: \"absolute\",\n      alignSelf: \"flex-end\",\n      right: 15,\n      padding: 10\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 485,\n      columnNumber: 41\n    }\n  }, React.createElement(Ionicons, {\n    style: {},\n    name: \"caret-down\",\n    size: 20,\n    color: \"#fff\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 496,\n      columnNumber: 13\n    }\n  }))), listStaff.map(function (item, index) {\n    var _handleDataHourTableS, _handleDataHourTableS2, _handleDataHourTableS3;\n\n    return React.createElement(View, {\n      key: index,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 502,\n        columnNumber: 13\n      }\n    }, React.createElement(ItemServiceTeam, {\n      item: item,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 503,\n        columnNumber: 15\n      }\n    }, React.createElement(View, {\n      style: {\n        paddingVertical: 10,\n        paddingHorizontal: 16\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 504,\n        columnNumber: 17\n      }\n    }, React.createElement(View, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 505,\n        columnNumber: 19\n      }\n    }, React.createElement(View, {\n      style: [styles.row_between, {\n        marginBottom: 16\n      }],\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 506,\n        columnNumber: 21\n      }\n    }, React.createElement(Text, {\n      style: [styles.textTitleHeader400, {\n        color: colors.gray\n      }],\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 507,\n        columnNumber: 23\n      }\n    }, \"Roster\"), React.createElement(Text, {\n      style: [styles.textTitleHeader400],\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 508,\n        columnNumber: 23\n      }\n    }, item ? item.dutyName : \"-\"))), React.createElement(Dash, {\n      dashStyle: {\n        height: 0.5\n      },\n      dashColor: colors.colorLine,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 511,\n        columnNumber: 19\n      }\n    })), React.createElement(ScrollView, {\n      horizontal: true,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 514,\n        columnNumber: 17\n      }\n    }, React.createElement(Table, {\n      style: {},\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 515,\n        columnNumber: 19\n      }\n    }, React.createElement(Row, {\n      data: tableHead,\n      widthArr: widthArr,\n      style: {\n        height: 50\n      },\n      textStyle: {\n        textAlign: \"center\",\n        color: \"#fff\"\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 516,\n        columnNumber: 21\n      }\n    }), React.createElement(Row, {\n      data: handleDataTableStaff(item),\n      widthArr: widthArr,\n      style: {\n        height: 50,\n        backgroundColor: \"#675E50\"\n      },\n      textStyle: {\n        textAlign: \"center\",\n        color: \"#fff\"\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 527,\n        columnNumber: 21\n      }\n    }))), React.createElement(View, {\n      style: {\n        paddingHorizontal: 16\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 541,\n        columnNumber: 17\n      }\n    }, React.createElement(View, {\n      style: [styles.row_between, {\n        marginVertical: 10\n      }],\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 542,\n        columnNumber: 19\n      }\n    }, React.createElement(Text, {\n      style: {\n        color: colors.gray\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 543,\n        columnNumber: 21\n      }\n    }, \"Actual working hours\"), React.createElement(Text, {\n      style: styles.textTitleHeader,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 544,\n        columnNumber: 21\n      }\n    }, item ? (_handleDataHourTableS = handleDataHourTableStaff(item, 'totalHoureWorking')) != null ? _handleDataHourTableS : \"-\" : \"-\")), React.createElement(View, {\n      style: styles.row_between,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 546,\n        columnNumber: 19\n      }\n    }, React.createElement(Text, {\n      style: {\n        color: colors.gray\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 547,\n        columnNumber: 21\n      }\n    }, \"OT\"), React.createElement(Text, {\n      style: styles.textTitleHeader,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 548,\n        columnNumber: 21\n      }\n    }, item ? (_handleDataHourTableS2 = handleDataHourTableStaff(item, 'totalHoureWorkingOT')) != null ? _handleDataHourTableS2 : \"-\" : \"-\")), React.createElement(View, {\n      style: [styles.row_between, {\n        marginVertical: 10\n      }],\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 550,\n        columnNumber: 19\n      }\n    }, React.createElement(Text, {\n      style: {\n        color: colors.gray\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 551,\n        columnNumber: 21\n      }\n    }, \"Total\"), React.createElement(Text, {\n      style: styles.textTitleHeader,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 552,\n        columnNumber: 21\n      }\n    }, item ? (_handleDataHourTableS3 = handleDataHourTableStaff(item, 'totalHoure')) != null ? _handleDataHourTableS3 : \"-\" : \"-\")))));\n  })), React.createElement(View, {\n    style: {\n      padding: 30\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 561,\n      columnNumber: 7\n    }\n  }, React.createElement(TouchableOpacity, {\n    onPress: function onPress() {\n      setModalSendMail(!modalSendMail);\n    },\n    style: {\n      width: 130,\n      alignSelf: \"center\"\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 562,\n      columnNumber: 9\n    }\n  }, React.createElement(LinearGradient, {\n    style: styles.buttonSend,\n    colors: [\"#DAB451\", \"#988050\"],\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 568,\n      columnNumber: 11\n    }\n  }, React.createElement(Text, {\n    style: styles.textButton,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 569,\n      columnNumber: 13\n    }\n  }, \"Confirm\")))), React.createElement(ModalSendEmail, {\n    visible: modalSendMail,\n    onRequestClose: function onRequestClose() {\n      setModalSendMail(!modalSendMail);\n    },\n    onRequestSend: function onRequestSend(description, email) {\n      handleSendMail(description, email);\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 573,\n      columnNumber: 7\n    }\n  }), React.createElement(SendSuccess, {\n    title: statusSent,\n    visible: sent === \"success\",\n    onRequestClose: function onRequestClose() {\n      return setSent(\"\");\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 582,\n      columnNumber: 7\n    }\n  }), React.createElement(SendFail, {\n    title: statusSent,\n    visible: sent === \"fail\",\n    onRequestClose: function onRequestClose() {\n      return setSent(\"\");\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 583,\n      columnNumber: 7\n    }\n  }), React.createElement(ModalPicker, {\n    visible: showPickerStore,\n    data: recordAreas,\n    onRequestClose: function onRequestClose() {\n      return setShowPickerStore(false);\n    },\n    onChange: function onChange(item) {\n      setValueStore(item);\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 584,\n      columnNumber: 7\n    }\n  }), React.createElement(ModalPicker, {\n    visible: showPickerTeam,\n    data: recordAreas,\n    onRequestClose: function onRequestClose() {\n      return setShowPickerTeam(false);\n    },\n    onChange: function onChange(item) {\n      setValueTeam(item);\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 592,\n      columnNumber: 7\n    }\n  }), isLoading && React.createElement(Loading, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 601,\n      columnNumber: 21\n    }\n  }));\n};\n\nexport default WeeklyCrewSchedule;\nvar styles = StyleSheet.create({\n  container: {\n    paddingHorizontal: 15\n  },\n  row_between: {\n    flexDirection: \"row\",\n    justifyContent: \"space-between\",\n    alignItems: \"center\"\n  },\n  center: {\n    paddingVertical: 10,\n    justifyContent: \"center\",\n    alignItems: \"center\"\n  },\n  radius_top: {\n    borderTopLeftRadius: 4,\n    borderTopRightRadius: 4\n  },\n  titleHeader: {\n    paddingVertical: 16,\n    borderBottomWidth: 1,\n    borderBottomColor: colors.colorLine\n  },\n  textTitleHeader: {\n    color: colors.colorText,\n    fontWeight: \"500\",\n    fontSize: 14\n  },\n  textTitleHeader400: {\n    color: colors.colorText,\n    fontWeight: \"400\",\n    fontSize: 14\n  },\n  blockColor: {\n    width: 12,\n    height: 12,\n    marginRight: 8\n  },\n  textButton: {\n    fontSize: 16,\n    color: colors.colorText\n  },\n  buttonSend: {\n    height: 36,\n    justifyContent: \"center\",\n    alignItems: \"center\",\n    borderRadius: 4\n  }\n});","map":{"version":3,"sources":["D:/angular/hts_reactnative/src/app/screens/details/TabManagement/StaffManagement/Reports/WeeklyCrewSchedule.tsx"],"names":["React","useState","useEffect","LinearGradient","colors","Ionicons","ItemServiceTeam","Table","Row","ModalSendEmail","ModalPicker","SendSuccess","SendFail","moment","Dash","StaffService","ReportStaffService","MailStaffService","Loading","InitHourService","initDataPicker","useSelector","getMonday","DropDown","WeeklyCrewSchedule","props","params","route","workingTimes","state","staff","record_area","staffs","reports","toDate","Date","isLoading","setIsLoading","tableHead","tableRow","widthArr","map","item","push","timeRange","slice","modalSendMail","setModalSendMail","sent","setSent","statusSent","setStatusSent","format","date","setDate","showPickerStore","setShowPickerStore","valueStore","setValueStore","showPickerTeam","setShowPickerTeam","valueTeam","setValueTeam","dataHourService","setDataHourService","dataHourServiceInWeek","setDataHourServiceInWeek","listStaff","setListStaff","recordAreas","setRecordAreas","tempStaffs","setTempStaffs","label","value","daySelect","setDaySelect","getDaysArray","start","end","arr","dt","getDate","weekDays","setWeekDays","handleSubmitWorking","req","edited","listWorking","workingScheduleData","WorkingWeekTime","LegendId","StaffId","id","WorkingScheduleData","createWorking","res","isSuccess","data","handleSendMail","description","email","submit","sendMailWeeklyCrewsCheduleAndOTForecastSample","loadHourStore","getHourStoreService","length","loadStaffByRecordArea","getStaffByRecordArea","memberInfos","t","loadWeeklyDynamicCrewScheduleByStaff","staffId","Promise","all","result","getWeeklyDynamicCrewScheduleByStaff","index","findIndex","i","list","dataTable","datahandle","staffWorkingDay","staffWorkingDayTimeData","tempCheckSplitTime","isOT","workingTimeId","undefined","_arrDays","fromDate","endDate","valueRecordArea","fromDateTime","endDateTime","listStaffParam","_dataHour","Array","from","_","totalHoureWorking","totalHoureWorkingOT","totalHoure","_staffWorkingDay","_dataTable","forEach","_totalHoureWorking","_totalHoureWorkingOT","_totalHoure","_dataRow","__index","WorkingDate","getDay","_index","e","dataHour","infoStaff","staffName","firstName","lastName","positionName","positionCode","positionId","dutyName","dutyId","dataTableInWeek","handleDataTableStaff","handleDataHourTableStaff","type","handleDataHourStore","toFixed","styles","container","paddingHorizontal","zIndex","titleHeader","textTitleHeader","textAlign","backgroundColor","colorLine","height","row_between","paddingVertical","color","gray","borderRadius","marginTop","grayLight","center","radius_top","name","toUpperCase","position","alignSelf","right","padding","marginVertical","flexDirection","justifyContent","marginBottom","textTitleHeader400","width","buttonSend","textButton","StyleSheet","create","alignItems","borderTopLeftRadius","borderTopRightRadius","borderBottomWidth","borderBottomColor","colorText","fontWeight","fontSize","blockColor","marginRight"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport { StyleSheet, Text, View, TouchableOpacity, ScrollView } from \"react-native\";\r\nimport { LinearGradient } from \"expo-linear-gradient\";\r\nimport { Icons, Images } from \"../../../../../assets\";\r\nimport { colors } from \"../../../../../utils/Colors\";\r\nimport { Ionicons } from \"@expo/vector-icons\";\r\nimport ItemServiceTeam from \"./items/itemServiceTeam\";\r\nimport { Table, Row } from \"react-native-table-component\";\r\nimport ModalSendEmail from \"../../../../../components/ModalSendEmail\";\r\nimport ModalPicker from \"../../../../../components/management/ModalPicker\";\r\nimport SendSuccess from \"../../../../../components/modalNotification/SendSuccess\";\r\nimport SendFail from \"../../../../../components/modalNotification/SendFail\";\r\nimport DateTimePickerModal from \"react-native-modal-datetime-picker\";\r\nimport moment from \"moment\";\r\nimport Dash from \"react-native-dash\";\r\nimport { StaffService, ReportStaffService, MailStaffService } from \"../../../../../netWorking/staffService\";\r\nimport Loading from \"../../../../../components/dialogs/Loading\";\r\nimport { IStaff, IHourService, InitHourService, IPicker, initDataPicker, IStaffInfoByRecordArea } from \"../../../../../models/staffModel\";\r\nimport DatePickerUnderLine from \"../../../../../components/DatePickerUnderLine\";\r\nimport { useSelector, useDispatch } from \"react-redux\";\r\nimport { RootState } from \"../../../../../redux/reducers\";\r\nimport { getMonday } from \"../../../../../components/generalConvert/conVertMonDay\";\r\nimport { RouteProp } from \"@react-navigation/native\";\r\nimport { StackNavigationProp } from \"@react-navigation/stack\";\r\nimport { TabManageParamList } from \"../../../../../types\";\r\nimport DropDown from \"../../../../../components/dropDown/DropDown\";\r\nimport { Imodel } from \"../../../../../models/Imodel\";\r\nexport interface Props {\r\n  route: RouteProp<TabManageParamList, \"Reports\">;\r\n  navigation: StackNavigationProp<TabManageParamList>;\r\n}\r\nconst WeeklyCrewSchedule = (props: { props: Props }) => {\r\n  const { params } = props.props.route\r\n  const workingTimes = useSelector((state: RootState) => state.staff.workingTimes);\r\n  const record_area = useSelector((state: RootState) => state.staff.record_area);\r\n  const staffs = useSelector((state: RootState) => state.staff.staffs);\r\n  const reports = useSelector((state: RootState) => state.reports);\r\n  const toDate = new Date();\r\n\r\n  const [isLoading, setIsLoading] = useState(false);\r\n\r\n  const tableHead = [];\r\n  const tableRow = [];\r\n  const widthArr = [];\r\n  workingTimes.map(item => {\r\n    tableHead.push(item.timeRange.slice(0, 5));\r\n    tableRow.push(\"-\");\r\n    widthArr.push(50);\r\n  });\r\n\r\n  const [modalSendMail, setModalSendMail] = useState(false);\r\n  const [sent, setSent] = useState(\"\");\r\n  const [statusSent, setStatusSent] = useState(\"\");\r\n  const [date, setDate] = useState(moment(new Date()).format(\"YYYY-MM-DD 00:00:00\"));\r\n\r\n  const [showPickerStore, setShowPickerStore] = useState(false);\r\n  const [valueStore, setValueStore] = useState<IPicker>(initDataPicker);\r\n  const [showPickerTeam, setShowPickerTeam] = useState(false);\r\n  const [valueTeam, setValueTeam] = useState<IPicker>(initDataPicker);\r\n\r\n  const [dataHourService, setDataHourService] = useState<IHourService>(InitHourService);\r\n  const [dataHourServiceInWeek, setDataHourServiceInWeek] = useState<IHourService[]>([]);\r\n  const [listStaff, setListStaff] = useState<IStaffInfoByRecordArea[]>([]);\r\n\r\n  const [recordAreas, setRecordAreas] = useState<IPicker[]>([]);\r\n  const [tempStaffs, setTempStaffs] = useState<IStaff[]>([]);\r\n\r\n\r\n  const [daySelect, setDaySelect] = useState<Imodel>({\r\n    label: moment(getMonday(toDate)).format(\"dddd (DD-MM-YYYY)\"),\r\n    value: +getMonday(toDate)\r\n  });\r\n  function getDaysArray(start: Date, end: Date) {\r\n    let arr = [];\r\n    for (let dt = start; new Date(dt) <= end; dt.setDate(dt.getDate() + 1)) {\r\n      arr.push({ value: +new Date(dt), label: moment(new Date(dt)).format(\"dddd (DD-MM-YYYY)\") });\r\n    }\r\n    return arr;\r\n  }\r\n  const [weekDays, setWeekDays] = useState<Imodel[]>([]);\r\n\r\n  const handleSubmitWorking = async () => {\r\n    let req = [];\r\n    tempStaffs.map(staff => {\r\n      if (staff.edited) {\r\n        let listWorking = [];\r\n        staff.workingScheduleData.map(item => {\r\n          if (item.WorkingWeekTime !== null || item.LegendId !== null) {\r\n            listWorking.push(item);\r\n          }\r\n        });\r\n        req.push({ StaffId: staff.id, WorkingScheduleData: listWorking });\r\n      }\r\n    });\r\n    const res = await StaffService.createWorking(req);\r\n    if (res.isSuccess == 1 && res.data) {\r\n      return true;\r\n    } else {\r\n      return false;\r\n    }\r\n  };\r\n  const handleSendMail = async (description: string, email: string) => {\r\n    let submit = false;\r\n    if (params?.data) {\r\n      submit = await handleSubmitWorking();\r\n    } else {\r\n      submit = true;\r\n    }\r\n    if (submit) {\r\n      setModalSendMail(!modalSendMail);\r\n      setIsLoading(true);\r\n      const res = await MailStaffService.sendMailWeeklyCrewsCheduleAndOTForecastSample(\r\n        moment(getMonday(new Date())).format(\"YYYY-MM-DD HH:mm:ss\"),\r\n        description,\r\n        email\r\n      );\r\n      setIsLoading(false);\r\n      if (res.isSuccess == 1 && res.data) {\r\n        setSent(\"success\");\r\n        setStatusSent(\"Email sent successfully!\");\r\n      } else {\r\n        setSent(\"fail\");\r\n        setStatusSent(\"Email sent failed!\");\r\n      }\r\n    } else {\r\n      setSent(\"fail\");\r\n      setStatusSent(\"Schedule work failed!\");\r\n    }\r\n  };\r\n  const loadHourStore = async () => {\r\n    const res = await ReportStaffService.getHourStoreService(moment(daySelect.value).format(\"YYYY-MM-DD 00:00:00\"), valueStore.id);\r\n    if (res.isSuccess == 1 && res.data.length > 0) {\r\n      setDataHourService(res.data[0]);\r\n    }\r\n  };\r\n  const loadStaffByRecordArea = async () => {\r\n    setIsLoading(true);\r\n    const res = await ReportStaffService.getStaffByRecordArea(valueTeam.id);\r\n    if (res.isSuccess == 1 && res.data) {\r\n      if (res.data.length > 0) {\r\n        setListStaff(res.data);\r\n        const memberInfos = res.data.map(async t => await loadWeeklyDynamicCrewScheduleByStaff(t.staffId, res.data));\r\n        const result: IStaffInfoByRecordArea[] = await Promise.all(memberInfos);\r\n        setListStaff(result);\r\n      } else {\r\n        setListStaff([]);\r\n      }\r\n    }\r\n    setIsLoading(false);\r\n  };\r\n\r\n  const loadWeeklyDynamicCrewScheduleByStaff = async (staffId: number, data: IStaffInfoByRecordArea[]) => {\r\n    const res = await ReportStaffService.getWeeklyDynamicCrewScheduleByStaff(staffId, moment(daySelect.value).format(\"YYYY-MM-DD 00:00:00\"), valueTeam.id);\r\n    if (res.isSuccess == 1 && res.data) {\r\n      let index = data.findIndex(i => i.staffId == staffId);\r\n      if (res.data.length > 0) {\r\n        let list = [...data];\r\n        if (index !== -1) {\r\n          let dataTable = [...tableRow];\r\n          list[index] = res.data[0];\r\n          let datahandle = list[index].staffWorkingDay[0].staffWorkingDayTimeData;\r\n          let tempCheckSplitTime = 0;\r\n          datahandle.map((item, index) => {\r\n            if (item.isOT) {\r\n              dataTable[item.workingTimeId - 1] = \"OT\";\r\n            } else {\r\n              dataTable[item.workingTimeId - 1] = \"N\";\r\n            }\r\n\r\n            // ui hiển thị thiếu giờ cuối cùng của mảng\r\n            if (index == datahandle.length - 1) {\r\n              dataTable[datahandle[index].workingTimeId] = dataTable[datahandle[index].workingTimeId - 1];\r\n            }\r\n            if (index == 0) {\r\n              tempCheckSplitTime = item.workingTimeId + 2\r\n            } else {\r\n              if (item.workingTimeId + 1 !== tempCheckSplitTime) {\r\n                dataTable[tempCheckSplitTime - 2] = dataTable[tempCheckSplitTime - 3];\r\n              } else {\r\n                tempCheckSplitTime = item.workingTimeId + 2\r\n              }\r\n            }\r\n          });\r\n          list[index].dataTable = dataTable;\r\n          return list[index];\r\n        }\r\n      } else {\r\n        return data[index];\r\n      }\r\n    }\r\n  };\r\n\r\n\r\n\r\n  useEffect(() => {\r\n    if (params.data === undefined) { loadHourStore(); }\r\n  }, [valueStore, daySelect.value]);\r\n  useEffect(() => {\r\n    if (params.data === undefined) { loadStaffByRecordArea(); }\r\n  }, [valueTeam, daySelect.value]);\r\n  useEffect(() => {\r\n    if (params.data === undefined) {\r\n      let _arrDays = getDaysArray(new Date(moment(reports.fromDate).format(\"YYYY-MM-DD\")), new Date(moment(reports.endDate).format(\"YYYY-MM-DD\")))\r\n      setWeekDays(_arrDays);\r\n      setDaySelect(_arrDays[0]);\r\n    }\r\n  }, [reports]);\r\n  useEffect(() => {\r\n    setRecordAreas(record_area);\r\n    setValueStore(record_area[0]);\r\n    setValueTeam(record_area[0]);\r\n    if (params?.data) {\r\n      setTempStaffs(staffs) // lưu lại staffs để comfirm\r\n      setValueStore(params.data.valueRecordArea);\r\n      setValueTeam(params.data.valueRecordArea);\r\n      let _arrDays = getDaysArray(new Date(moment(params.data.fromDateTime).format(\"YYYY-MM-DD\")), new Date(moment(params.data.endDateTime).format(\"YYYY-MM-DD\")))\r\n      setWeekDays(_arrDays);\r\n      setDaySelect(_arrDays[0]);\r\n      let listStaffParam = []\r\n\r\n      let _dataHour: IHourService[] = Array.from({ length: 7 }).map(_ => ({\r\n        totalHoureWorking: 0,\r\n        totalHoureWorkingOT: 0,\r\n        totalHoure: 0,\r\n      }));\r\n      staffs.map(item => {\r\n        let _staffWorkingDay = []\r\n        let _dataTable = []\r\n        // item.workingScheduleData.forEach(i => {\r\n        //   let _totalHoureWorking = 0\r\n        //   let _totalHoureWorkingOT = 0\r\n        //   let _totalHoure = 0\r\n        //   let _dataRow = [...tableRow]\r\n        //   let _index = new Date(moment(i.WorkingDate).format('YYYY-MM-DD')).getDay() - 1\r\n        //   if (_index === -1) {\r\n        //     _index = 6\r\n        //   }\r\n\r\n        //   if (i.WorkingWeekTime !== null && i.WorkingWeekTime.length > 0) {\r\n        //     _totalHoureWorking = i.WorkingWeekTime[0].WorkingWeekTimeId.length / 2;\r\n        //     _totalHoure = i.WorkingWeekTime[0].WorkingWeekTimeId.length / 2;\r\n\r\n\r\n        //     if (i.WorkingWeekTime[0].OT == 1) {\r\n        //       let tempCheckSplitTime = 0;\r\n        //       i.WorkingWeekTime[0].WorkingWeekTimeId.map((id, index) => {\r\n        //         if (index == 0) {\r\n        //           tempCheckSplitTime = id + 2\r\n        //         } else {\r\n        //           if (id + 1 !== tempCheckSplitTime) {\r\n        //             _dataRow[tempCheckSplitTime - 2] = \"OT\";\r\n        //           } else {\r\n        //             tempCheckSplitTime = id + 2\r\n        //           }\r\n        //         }\r\n        //         _dataRow[id - 1] = \"OT\";\r\n        //       })\r\n        //       _dataRow[i.WorkingWeekTime[0].WorkingWeekTimeId[i.WorkingWeekTime[0].WorkingWeekTimeId.length - 1]] = \"OT\";\r\n        //       _totalHoureWorkingOT = i.WorkingWeekTime[0].WorkingWeekTimeId.length / 2\r\n        //       _totalHoure += i.WorkingWeekTime[0].WorkingWeekTimeId.length / 2\r\n        //     } else {\r\n        //       let tempCheckSplitTime = 0; // check xem có ca gãy hay không\r\n        //       i.WorkingWeekTime[0].WorkingWeekTimeId.map((id, index) => {\r\n        //         if (index == 0) {\r\n        //           tempCheckSplitTime = id + 2\r\n        //         } else {\r\n        //           if (id + 1 !== tempCheckSplitTime) {\r\n        //             _dataRow[tempCheckSplitTime - 2] = \"N\";\r\n        //           } else {\r\n        //             tempCheckSplitTime = id + 2\r\n        //           }\r\n        //         }\r\n        //         _dataRow[id - 1] = \"N\";\r\n        //       })\r\n        //       _dataRow[i.WorkingWeekTime[0].WorkingWeekTimeId[i.WorkingWeekTime[0].WorkingWeekTimeId.length - 1]] = \"N\";\r\n        //     }\r\n        //   }\r\n        //   _dataTable.push({\r\n        //     date: i.WorkingDate, data: _dataRow,\r\n        //     dataHour: { totalHoureWorking: _totalHoureWorking, totalHoureWorkingOT: _totalHoureWorkingOT, totalHoure: _totalHoure }\r\n        //   });\r\n        //   _dataHour[_index].totalHoure += _totalHoure\r\n        //   _dataHour[_index].totalHoureWorkingOT += _totalHoureWorkingOT\r\n        //   _dataHour[_index].totalHoureWorking += _totalHoureWorking\r\n        // })\r\n\r\n        item.staffWorkingDayTimeData.forEach(i => {\r\n          let _totalHoureWorking = 0\r\n          let _totalHoureWorkingOT = 0\r\n          let _totalHoure = 0\r\n          let _dataRow = [...tableRow]\r\n          let __index = new Date(moment(i.WorkingDate).format('YYYY-MM-DD')).getDay() - 1\r\n          if (__index === -1) {\r\n            __index = 6\r\n          }\r\n          let datahandle = i.staffWorkingDayTimeData;\r\n          let tempCheckSplitTime = 0;\r\n          datahandle.map((item, index) => {\r\n            if (item.isOT) {\r\n              _dataRow[item.workingTimeId - 1] = \"OT\";\r\n              _totalHoureWorkingOT = _totalHoureWorkingOT + 1;\r\n            } else {\r\n              _totalHoureWorking += 1;\r\n              _dataRow[item.workingTimeId - 1] = \"N\";\r\n            }\r\n\r\n            // ui hiển thị thiếu giờ cuối cùng của mảng\r\n            if (index == datahandle.length - 1) {\r\n              _dataRow[datahandle[index].workingTimeId] = _dataRow[datahandle[index].workingTimeId - 1];\r\n            }\r\n            if (index == 0) {\r\n              tempCheckSplitTime = item.workingTimeId + 2\r\n            } else {\r\n              if (item.workingTimeId + 1 !== tempCheckSplitTime) {\r\n                _dataRow[tempCheckSplitTime - 2] = _dataRow[tempCheckSplitTime - 3];\r\n              } else {\r\n                tempCheckSplitTime = item.workingTimeId + 2\r\n              }\r\n            }\r\n          });\r\n          let _index = _dataTable.findIndex(e => e.date == i.WorkingDate)\r\n          if (_index !== -1) {\r\n            _dataTable[_index].data = _dataRow\r\n          }\r\n          _totalHoure = _totalHoureWorking + _totalHoureWorkingOT;\r\n          _dataTable.push({\r\n            date: i.WorkingDate, data: _dataRow,\r\n            dataHour: { totalHoureWorking: _totalHoureWorking / 2, totalHoureWorkingOT: _totalHoureWorkingOT / 2, totalHoure: _totalHoure / 2 }\r\n          });\r\n          _dataHour[__index].totalHoure += _totalHoure / 2\r\n          _dataHour[__index].totalHoureWorkingOT += _totalHoureWorkingOT / 2\r\n          _dataHour[__index].totalHoureWorking += _totalHoureWorking / 2\r\n        })\r\n\r\n\r\n        let infoStaff = {\r\n          staffId: item.id,\r\n          staffName: `${item.firstName}${item.lastName}`,\r\n          positionName: item.positionName,\r\n          positionCode: item.positionId,\r\n          dutyName: item.dutyName,\r\n          dutyId: item.dutyId,\r\n          dataTable: [],\r\n          dataTableInWeek: _dataTable,\r\n        }\r\n        listStaffParam.push(infoStaff)\r\n      })\r\n      setDataHourServiceInWeek(_dataHour)\r\n      setListStaff(listStaffParam)\r\n    }\r\n  }, []);\r\n  const handleDataTableStaff = (item: IStaffInfoByRecordArea) => {\r\n    if (params?.data) {\r\n      let index = item.dataTableInWeek.findIndex(item => +new Date(moment(item.date).format(\"YYYY-MM-DD\")) === +new Date(daySelect.value))\r\n      if (index !== -1) {\r\n        return item.dataTableInWeek[index].data\r\n      }\r\n    } else {\r\n      return item ? item.dataTable ?? tableRow : tableRow\r\n    }\r\n  }\r\n  const handleDataHourTableStaff = (item: IStaffInfoByRecordArea, type: string) => {\r\n    if (params?.data) {\r\n      let index = item.dataTableInWeek.findIndex(item => +new Date(moment(item.date).format(\"YYYY-MM-DD\")) === +new Date(daySelect.value))\r\n      if (index !== -1) {\r\n        return item.dataTableInWeek[index].dataHour[type]\r\n      }\r\n    } else {\r\n      return item[type]\r\n    }\r\n  }\r\n  const handleDataHourStore = (type: string) => {\r\n    if (params?.data) {\r\n      let index = new Date(daySelect.value).getDay() - 1\r\n      if (index !== -1 && dataHourServiceInWeek.length > 0) {\r\n        return dataHourServiceInWeek[index][type]\r\n      }\r\n    } else {\r\n      return dataHourService[type] ? dataHourService[type].toFixed(1) : \"-\"\r\n    }\r\n  }\r\n  return (\r\n    <View style={styles.container}>\r\n      <View style={{ paddingHorizontal: 15, zIndex: 2 }}>\r\n        <View style={styles.titleHeader}>\r\n          <Text style={[styles.textTitleHeader, { textAlign: \"center\" }]}>Weekly crew schedule & OT Forecast Sample</Text>\r\n        </View>\r\n        {/* <DatePickerUnderLine\r\n          onSubmit={date => {\r\n            setDate(date);\r\n          }}\r\n        ></DatePickerUnderLine> */}\r\n        <View style={{ zIndex: 2 }}>\r\n          <DropDown\r\n            data={weekDays}\r\n            onSelected={value => {\r\n              setDaySelect(value);\r\n            }}\r\n            backgroundColor={{ backgroundColor: \"transparent\" }}\r\n            value={daySelect}\r\n          ></DropDown>\r\n        </View>\r\n\r\n        <View style={{ backgroundColor: colors.colorLine, height: .5 }}></View>\r\n\r\n        <View style={[styles.row_between, { paddingVertical: 10 }]}>\r\n          <Text style={{ color: colors.gray }}>Start time of day:</Text>\r\n          <Text style={styles.textTitleHeader}>00:00</Text>\r\n        </View>\r\n      </View>\r\n      <View\r\n        style={{\r\n          borderRadius: 4,\r\n          marginTop: 6,\r\n          backgroundColor: colors.grayLight,\r\n        }}\r\n      >\r\n        <View style={[styles.center, styles.radius_top, { backgroundColor: \"#878787\" }]}>\r\n          <Text style={styles.textTitleHeader}>{`STORE_${valueStore.name.toUpperCase()}`}</Text>\r\n          {params.data === undefined && <TouchableOpacity\r\n            onPress={() => {\r\n              setShowPickerStore(!showPickerStore);\r\n            }}\r\n            style={{\r\n              position: \"absolute\",\r\n              alignSelf: \"flex-end\",\r\n              right: 15,\r\n              padding: 10,\r\n            }}\r\n          >\r\n            <Ionicons style={{}} name=\"caret-down\" size={20} color=\"#fff\"></Ionicons>\r\n          </TouchableOpacity>}\r\n\r\n        </View>\r\n\r\n        <View style={{ padding: 15 }}>\r\n          <View>\r\n            <View style={[styles.row_between, { marginVertical: 10 }]}>\r\n              <Text style={{ color: colors.gray }}>Actual working hours</Text>\r\n              <Text style={styles.textTitleHeader}>\r\n                {handleDataHourStore('totalHoureWorking')}\r\n              </Text>\r\n            </View>\r\n            <View style={styles.row_between}>\r\n              <Text style={{ color: colors.gray }}>OT</Text>\r\n              <Text style={styles.textTitleHeader}>\r\n                {handleDataHourStore('totalHoureWorkingOT')}\r\n              </Text>\r\n            </View>\r\n            <View style={[styles.row_between, { marginVertical: 10 }]}>\r\n              <Text style={{ color: colors.gray }}>Total</Text>\r\n              <Text style={styles.textTitleHeader}>\r\n                {handleDataHourStore('totalHoure')}\r\n              </Text>\r\n            </View>\r\n          </View>\r\n        </View>\r\n      </View>\r\n\r\n      <View\r\n        style={{\r\n          borderRadius: 4,\r\n          marginTop: 6,\r\n          backgroundColor: colors.grayLight,\r\n        }}\r\n      >\r\n        <View style={[styles.row_between, styles.radius_top, { padding: 15 }]}>\r\n          <View style={{ flexDirection: \"row\" }}>\r\n            <Text style={styles.textTitleHeader}>N: </Text>\r\n            <Text style={[styles.textTitleHeader, { color: colors.gray }]}>Normal Working Hour</Text>\r\n          </View>\r\n          <View style={{ flexDirection: \"row\" }}>\r\n            <Text style={styles.textTitleHeader}>OT: </Text>\r\n            <Text style={[styles.textTitleHeader, { color: colors.gray }]}>Overtime</Text>\r\n          </View>\r\n        </View>\r\n        <View\r\n          style={{\r\n            backgroundColor: \"#878787\",\r\n            padding: 15,\r\n            justifyContent: \"center\",\r\n          }}\r\n        >\r\n          <Text style={[styles.textTitleHeader, { alignSelf: \"center\" }]}>{`${valueTeam.name.toUpperCase()} TEAM`}</Text>\r\n          {params.data === undefined && <TouchableOpacity\r\n            onPress={() => {\r\n              setShowPickerTeam(!showPickerTeam);\r\n            }}\r\n            style={{\r\n              position: \"absolute\",\r\n              alignSelf: \"flex-end\",\r\n              right: 15,\r\n              padding: 10,\r\n            }}\r\n          >\r\n            <Ionicons style={{}} name=\"caret-down\" size={20} color=\"#fff\"></Ionicons>\r\n          </TouchableOpacity>}\r\n\r\n        </View>\r\n        {listStaff.map((item, index) => {\r\n          return (\r\n            <View key={index}>\r\n              <ItemServiceTeam item={item}>\r\n                <View style={{ paddingVertical: 10, paddingHorizontal: 16 }}>\r\n                  <View>\r\n                    <View style={[styles.row_between, { marginBottom: 16 }]}>\r\n                      <Text style={[styles.textTitleHeader400, { color: colors.gray }]}>Roster</Text>\r\n                      <Text style={[styles.textTitleHeader400]}>{item ? item.dutyName : \"-\"}</Text>\r\n                    </View>\r\n                  </View>\r\n                  <Dash dashStyle={{ height: 0.5 }} dashColor={colors.colorLine} />\r\n                </View>\r\n\r\n                <ScrollView horizontal={true}>\r\n                  <Table style={{}}>\r\n                    <Row\r\n                      data={tableHead}\r\n                      widthArr={widthArr}\r\n                      style={{\r\n                        height: 50,\r\n                      }}\r\n                      textStyle={{\r\n                        textAlign: \"center\",\r\n                        color: \"#fff\",\r\n                      }}\r\n                    />\r\n                    <Row\r\n                      data={handleDataTableStaff(item)}\r\n                      widthArr={widthArr}\r\n                      style={{\r\n                        height: 50,\r\n                        backgroundColor: \"#675E50\",\r\n                      }}\r\n                      textStyle={{\r\n                        textAlign: \"center\",\r\n                        color: \"#fff\",\r\n                      }}\r\n                    />\r\n                  </Table>\r\n                </ScrollView>\r\n                <View style={{ paddingHorizontal: 16 }}>\r\n                  <View style={[styles.row_between, { marginVertical: 10 }]}>\r\n                    <Text style={{ color: colors.gray }}>Actual working hours</Text>\r\n                    <Text style={styles.textTitleHeader}>{item ? handleDataHourTableStaff(item, 'totalHoureWorking') ?? \"-\" : \"-\"}</Text>\r\n                  </View>\r\n                  <View style={styles.row_between}>\r\n                    <Text style={{ color: colors.gray }}>OT</Text>\r\n                    <Text style={styles.textTitleHeader}>{item ? handleDataHourTableStaff(item, 'totalHoureWorkingOT') ?? \"-\" : \"-\"}</Text>\r\n                  </View>\r\n                  <View style={[styles.row_between, { marginVertical: 10 }]}>\r\n                    <Text style={{ color: colors.gray }}>Total</Text>\r\n                    <Text style={styles.textTitleHeader}>{item ? handleDataHourTableStaff(item, 'totalHoure') ?? \"-\" : \"-\"}</Text>\r\n                  </View>\r\n                </View>\r\n              </ItemServiceTeam>\r\n            </View>\r\n          );\r\n        })}\r\n      </View>\r\n\r\n      <View style={{ padding: 30 }}>\r\n        <TouchableOpacity\r\n          onPress={() => {\r\n            setModalSendMail(!modalSendMail);\r\n          }}\r\n          style={{ width: 130, alignSelf: \"center\" }}\r\n        >\r\n          <LinearGradient style={styles.buttonSend} colors={[\"#DAB451\", \"#988050\"]}>\r\n            <Text style={styles.textButton}>Confirm</Text>\r\n          </LinearGradient>\r\n        </TouchableOpacity>\r\n      </View>\r\n      <ModalSendEmail\r\n        visible={modalSendMail}\r\n        onRequestClose={() => {\r\n          setModalSendMail(!modalSendMail);\r\n        }}\r\n        onRequestSend={(description, email) => {\r\n          handleSendMail(description, email);\r\n        }}\r\n      ></ModalSendEmail>\r\n      <SendSuccess title={statusSent} visible={sent === \"success\"} onRequestClose={() => setSent(\"\")}></SendSuccess>\r\n      <SendFail title={statusSent} visible={sent === \"fail\"} onRequestClose={() => setSent(\"\")}></SendFail>\r\n      <ModalPicker\r\n        visible={showPickerStore}\r\n        data={recordAreas}\r\n        onRequestClose={() => setShowPickerStore(false)}\r\n        onChange={item => {\r\n          setValueStore(item);\r\n        }}\r\n      ></ModalPicker>\r\n      <ModalPicker\r\n        visible={showPickerTeam}\r\n        data={recordAreas}\r\n        onRequestClose={() => setShowPickerTeam(false)}\r\n        onChange={item => {\r\n          setValueTeam(item);\r\n        }}\r\n      ></ModalPicker>\r\n\r\n      {isLoading && <Loading />}\r\n    </View>\r\n  );\r\n};\r\n\r\nexport default WeeklyCrewSchedule;\r\n\r\nconst styles = StyleSheet.create({\r\n  container: {\r\n    paddingHorizontal: 15,\r\n  },\r\n  row_between: {\r\n    flexDirection: \"row\",\r\n    justifyContent: \"space-between\",\r\n    alignItems: \"center\",\r\n  },\r\n  center: {\r\n    paddingVertical: 10,\r\n    justifyContent: \"center\",\r\n    alignItems: \"center\",\r\n  },\r\n  radius_top: {\r\n    borderTopLeftRadius: 4,\r\n    borderTopRightRadius: 4,\r\n  },\r\n  titleHeader: {\r\n    paddingVertical: 16,\r\n    borderBottomWidth: 1,\r\n    borderBottomColor: colors.colorLine,\r\n  },\r\n  textTitleHeader: {\r\n    color: colors.colorText,\r\n    fontWeight: \"500\",\r\n    fontSize: 14,\r\n  },\r\n  textTitleHeader400: {\r\n    color: colors.colorText,\r\n    fontWeight: \"400\",\r\n    fontSize: 14,\r\n  },\r\n  blockColor: {\r\n    width: 12,\r\n    height: 12,\r\n    marginRight: 8,\r\n  },\r\n  textButton: {\r\n    fontSize: 16,\r\n    color: colors.colorText,\r\n  },\r\n  buttonSend: {\r\n    height: 36,\r\n    justifyContent: \"center\",\r\n    alignItems: \"center\",\r\n    borderRadius: 4,\r\n  },\r\n});\r\n"]},"metadata":{},"sourceType":"module"}